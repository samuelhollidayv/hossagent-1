This is exactly right: we built a whole telescope and then closed the lens cap.

You just articulated the core bug in 3 sentences:

The signal already has the contact info.
We strip it down to just the name.
Then we complain we ‚Äúdon‚Äôt know how to reach them.‚Äù

So let‚Äôs do the thing we always end up doing: turn your rant into a clean, atomic, feedable spell for Melissa.

Below is the MagicBox-ready prompt that tells her exactly how to fix the Signal ‚Üí LeadEvent ‚Üí Enrichment chain so we stop throwing away gold and start emailing real humans.

No extra commentary, you can paste this 1:1.

‚∏ª

üîÆ MAGICBOX PROMPT ‚Äî FIX SIGNAL ‚Üí LEAD CONTACT PIPELINE

You are working on my HossAgent app.

Right now, SignalNet finds articles like:

‚ÄúMiami Best Roofing Announces Expansion to Three New Locations‚Äù

The article already contains:
	‚Ä¢	a website URL (e.g. https://miamiroofing.com)
	‚Ä¢	a phone number
	‚Ä¢	sometimes an email
	‚Ä¢	clear geo context

But the current pipeline:
	‚Ä¢	extracts only company_name = "Miami Best Roofing"
	‚Ä¢	throws away URLs/phones/emails
	‚Ä¢	creates a LeadEvent with lead_domain = null, lead_email = null
	‚Ä¢	then the enrichment pipeline refuses to run because it ‚Äúneeds a domain‚Äù

Result: 0 real outbound, dead pipeline.

Your task is to fix the signal-to-contact pipeline end-to-end so we keep and propagate contact info from the moment we see it.

‚∏ª

1. Extend the Signal model with metadata

In the Signal model (whatever file defines it), add a flexible metadata field that can store extracted contact info:
	‚Ä¢	metadata (JSON/dict) containing at least:
	‚Ä¢	extracted_urls: List[str]
	‚Ä¢	extracted_phones: List[str]
	‚Ä¢	extracted_emails: List[str]
	‚Ä¢	source_confidence: float (0‚Äì1, optional)

Example structure:

{
  "extracted_urls": ["https://miamiroofing.com", "https://www.facebook.com/miamiroofing"],
  "extracted_phones": ["(305) 555-0147"],
  "extracted_emails": ["info@miamiroofing.com"],
  "source_confidence": 0.9
}

If a Signal model or table already exists, write a migration to add this metadata field (JSON/text column).

‚∏ª

2. Update news_search (and similar) signal sources

For the news / article‚Äìbased Signal sources (e.g. news_search, RSS, press releases):
	1.	After fetching article HTML or text, implement a helper:

def extract_contact_from_article(text: str) -> Dict[str, List[str]]:
    return {
        "urls": find_urls(text),
        "phones": PHONE_REGEX.findall(text),
        "emails": EMAIL_REGEX.findall(text),
    }

Where:
	‚Ä¢	find_urls uses a robust URL regex, e.g.:
https?://[^\s<>"{}|\\^\\[\\]]+
	‚Ä¢	PHONE_REGEX is whatever existing phone pattern we use (or add a sane one)
	‚Ä¢	EMAIL_REGEX is our existing email regex

	2.	When creating a Signal from a news article:

	‚Ä¢	Set signal.metadata["extracted_urls"] to the URLs
	‚Ä¢	Set signal.metadata["extracted_phones"] to the phones
	‚Ä¢	Set signal.metadata["extracted_emails"] to the emails
	‚Ä¢	Optionally set source_confidence if you can score how good the match is

Important: Do NOT throw this data away. Store it on the Signal object.

‚∏ª

3. Use Signal metadata when creating LeadEvents

Wherever we create LeadEvent objects from Signal objects (e.g. in a create_lead_event_from_signal function or equivalent):
	1.	Pull contact info from signal.metadata:

metadata = signal.metadata or {}
urls = metadata.get("extracted_urls", [])
emails = metadata.get("extracted_emails", [])
phones = metadata.get("extracted_phones", [])

	2.	Implement helpers:

	‚Ä¢	extract_clean_domain(url: str) -> Optional[str]
	‚Ä¢	Strip protocol, path, query, www.
	‚Ä¢	Return just the root domain like miamiroofing.com.
	‚Ä¢	validate_and_clean_email(email: str) -> Optional[str]
	‚Ä¢	Lowercase, trim whitespace, basic format validation.

	3.	When instantiating a LeadEvent:

	‚Ä¢	lead_domain = extract_clean_domain(urls[0]) if urls else None
	‚Ä¢	lead_email = validate_and_clean_email(emails[0]) if emails else None
	‚Ä¢	lead_phone = phones[0] if phones else None (optional, if model supports it)

Do NOT overwrite existing values if they‚Äôre already set from other sources; only populate when they‚Äôre null.

‚∏ª

4. Update enrichment pipeline to respect pre-populated contact info

In the enrichment / lead enrichment pipeline:
	1.	If lead_email is already set and valid:

	‚Ä¢	Do not block on missing domain.
	‚Ä¢	Mark the event as enriched (or at least ‚Äúready for BizDev‚Äù).
	‚Ä¢	Optionally run a quick verification step if we already have a helper for that.
	‚Ä¢	Skip unnecessary scraping/domain guessing.

	2.	If lead_domain is set but lead_email is not:

	‚Ä¢	Run the existing domain-based scraping logic (contact page crawl, etc.).
	‚Ä¢	Fill lead_email if found.

	3.	If neither domain nor email is available even after reading Signal metadata:

	‚Ä¢	Optionally fall back to existing company-enrichment API (Apollo etc.), if configured.
	‚Ä¢	If still nothing: mark enrichment_status = FAILED or similar, and log clearly.

Key behavior change:
	‚Ä¢	No more ‚Äúno domain, skip enrichment, skip BizDev‚Äù when we already have an email in the original signal.

‚∏ª

5. Use email-first when possible

For BizDev outbound:
	‚Ä¢	If lead_email is present and valid, use it as the outbound target.
	‚Ä¢	If only lead_domain is present, follow current logic (e.g. find contact emails via enrichment).
	‚Ä¢	Do NOT create BizDev outbound for signals that refer to the customer‚Äôs own business; those are internal/insight signals, not leads.

This ensures:
	‚Ä¢	Many LeadEvents will arrive already ready-to-email.
	‚Ä¢	The pipeline no longer dies at the ‚Äúno domain‚Äù step when the article already gave us an email.

‚∏ª

6. Admin / Debug visibility

Update the Admin Console Signals / LeadEvents views to show:
	‚Ä¢	For each Signal:
	‚Ä¢	extracted_urls
	‚Ä¢	extracted_emails
	‚Ä¢	extracted_phones
	‚Ä¢	For each LeadEvent:
	‚Ä¢	lead_domain
	‚Ä¢	lead_email
	‚Ä¢	reference back to signal_id

This is for debugging and trust: I should be able to click from a LeadEvent back to the Signal and see exactly where the domain/email came from.

‚∏ª

7. Success criteria

After implementing:
	1.	Create a test news article/fixture that clearly includes:
	‚Ä¢	company name
	‚Ä¢	URL
	‚Ä¢	phone
	‚Ä¢	email
	2.	Run SignalNet ‚Üí LeadEvent ‚Üí Enrichment.
	3.	Confirm in the database / admin console that:

	‚Ä¢	Signal.metadata has URLs/emails/phones.
	‚Ä¢	LeadEvent created with:
	‚Ä¢	company_name correctly populated
	‚Ä¢	lead_domain set from the article URL
	‚Ä¢	lead_email set from the article email
	‚Ä¢	Enrichment does not skip purely due to missing domain if email is already present.
	‚Ä¢	BizDev sees a LeadEvent with a usable lead_email and is able to generate outbound.

Log any assumptions inline in comments.

Do NOT change business logic around scoring or geo/niche filtering.
This task is ONLY about: stop throwing away contact information at the signal stage, and propagate it cleanly through LeadEvents into enrichment and BizDev.

‚∏ª

Drop that into Melissa and let her wire it.

You just fixed the part where we were reading the obituary and then forgetting the address.